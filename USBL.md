# Разработка и оптимизация системы подводного позиционирования USBL

## 1. Общая информация

**Наименование проекта:** Разработка и оптимизация системы подводного позиционирования USBL с оптимизацией геометрии антенны.

**Назначение системы:** Определение пространственных координат подводного объекта (ответчика/маяка) относительно носителя (ПА, судно, буй) с заданной точностью.

**Основная цель разработки:** Оптимизация геометрии приемной антенны USBL и параметров сигнала (частотная полоса, длительность, SNR) для достижения заданной точности позиционирования на различных дистанциях.

## 2. Объект и условия применения

- **Среда распространения:** морская вода
- **Глубины:** до 6000 м
- **Дистанции до маяка:** 10–3000 м (уточняются на этапе моделирования)
- **Скорость звука:** 1450–1550 м/с (с учетом неопределенности и профиля SVP)

$$c = 1450 \text{–} 1550 \text{ м/с}$$

- **Наличие шумов:** фоновый шум моря, собственные шумы приемников

## 3. Архитектура USBL-системы

### 3.0 Приемная часть (Front-End)

Приемная часть предназначена для преобразования акустического сигнала в электрический, усиления и подготовки сигнала к цифровой обработке.

#### 3.0.1 Приемные антенны (акустические трансдусеры)

- рабочий частотный диапазон: $[f_{\min}, f_{\max}]$
- центральная частота: $f_0 = \frac{f_{\min} + f_{\max}}{2}$
- чувствительность: $S_{RX}$ (дБ re 1 В/µПа)
- полоса пропускания: $B_{tr} = f_{\max} - f_{\min}$
- диаграмма направленности (предпочтительно изотропная)
- фазовая стабильность между каналами
- допустимая глубина (до 6000 м)
- температурная и давленческая стабильность

#### 3.0.2 Малошумящий усилитель (LNA)

- коэффициент усиления: $G_{LNA}$ (дБ)
- коэффициент шума (Noise Figure): $NF_{LNA}$ (дБ)
- согласование с трансдусером
- стабильность усиления по температуре и давлению

#### 3.0.3 Усилитель с регулируемым коэффициентом усиления (VGA)

- диапазон регулировки усиления: $G_{VGA} \in [G_{VGA,\min}, G_{VGA,\max}]$ (дБ)
- шаг регулировки: $\Delta G_{VGA}$ (дБ)
- линейность
- согласованность усиления между каналами

**Общее усиление приемного тракта:**

$$G_{RX} = S_{RX} + G_{LNA} + G_{VGA} \text{ (дБ)}$$

### 3.1 Логическое разделение системы

#### 3.1.1 Вычислительный модуль (Core / Compute)

- обработка сигналов приемников
- вычисление разностей фаз и времен прихода
- оценка направления прихода сигнала (DOA)
- оценка дальности
- расчет координат и ошибок
- оптимизация параметров (геометрия, частота, полоса)

#### 3.1.2 Модуль данных (Data)

- хранение входных и выходных данных
- воспроизводимость расчетов
- пакетная обработка и экспорт

#### 3.1.3 Пользовательский интерфейс (GUI)

- задание сценариев моделирования
- визуализация геометрии антенны
- отображение результатов и метрик точности

### 3.2 Рассматриваемые геометрии антенн

#### Вариант A: «Ромб (пространственный)»

- 4 приемника: 3 в основании (треугольник), 1 в вершине
- оптимизация: размер основания $a$, высота вершины $h$, ориентация

**Геометрия:**
- Базис треугольника: $a$
- Высота пирамиды: $h$
- Координаты приемников: $\mathbf{r}_i = (x_i, y_i, z_i)$, $i = 1, 2, 3, 4$

#### Вариант B: «Пирамида»

- 5 приемников: 4 в основании + 1 в вершине
- оптимизация: размер основания $a$, высота пирамиды $h$

**Геометрия:**
- Базис квадрата: $a$
- Высота пирамиды: $h$
- Координаты приемников: $\mathbf{r}_i = (x_i, y_i, z_i)$, $i = 1, 2, 3, 4, 5$

## 4. Модель распространения сигнала

### 4.1 Затухание сигнала

Затухание акустического сигнала в морской воде описывается формулой:

$$L(D) = 20 \log_{10}(D) + \alpha D + 60$$

где:
- $L(D)$ — потери при распространении (дБ)
- $D$ — дальность (м)
- $\alpha$ — коэффициент поглощения (дБ/м), зависящий от частоты

### 4.2 Уровень сигнала на приемнике

Уровень сигнала на входе приемника:

$$P_{RX} = P_{TX} - L(D) + G_{TX} + G_{RX} \text{ (дБ re 1 µПа)}$$

где:
- $P_{TX}$ — уровень излучаемого сигнала (дБ re 1 µПа @ 1 м)
- $G_{TX}$ — коэффициент усиления передающей антенны (дБ)
- $G_{RX}$ — коэффициент усиления приемной антенны (дБ)

### 4.3 Отношение сигнал/шум (SNR)

$$SNR = P_{RX} - P_{noise} \text{ (дБ)}$$

где $P_{noise}$ — уровень шума (дБ re 1 µPa), включающий:
- фоновый шум моря
- собственные шумы приемников
- шумы усилителей

**SNR на выходе ADC:**

$$SNR_{ADC} = SNR + G_{LNA} + G_{VGA} - NF_{total} \text{ (дБ)}$$

где $NF_{total}$ — общий коэффициент шума системы.

## 5. Параметры сигнала

### 5.1 CHIRP-сигнал

Используется широкополосный CHIRP-сигнал для улучшения точности оценки дальности:

$$s(t) = A \cos\left(2\pi \left(f_0 t + \frac{B}{2T_p} t^2\right)\right), \quad 0 \leq t \leq T_p$$

где:
- $A$ — амплитуда сигнала
- $f_0$ — начальная частота (Гц)
- $B = f_{end} - f_{start}$ — полоса частот (Гц)
- $T_p$ — длительность импульса (с)

### 5.2 Ограничения на параметры

**Критерий Найквиста:**

$$f_s \geq 2 f_{end}$$

где $f_s$ — частота дискретизации (Гц).

**Максимальная длительность импульса:**

$$T_{p,\max} = \frac{2D}{c} - \tau_{guard}$$

где $\tau_{guard}$ — защитный интервал для предотвращения перекрытия с эхо-сигналами.

## 6. Оценка координат

### 6.1 Оценка углов (DOA — Direction of Arrival)

Оценка направления прихода сигнала осуществляется на основе фазовой интерферометрии и не содержит информации о дальности до источника.

Результатом оценки DOA является единичный вектор направления $\mathbf{s}$, указывающий на маяк, но не определяющий расстояние до него.

**Разъяснение:**
- DOA даёт только направление на источник (азимут и угол места)
- единичный вектор $\mathbf{s}$ задаёт луч, на котором может находиться источник
- абсолютная дальность вдоль этого луча не наблюдаема при малой базе (USBL)
- дальность можно оценить только независимо (TOA, корреляция, пассивный/активный метод)

#### 6.1.1 Входные данные для DOA

- комплексные сигналы с каждого приемника: $S_i = |S_i| e^{j\phi_i}$
- координаты приемников: $\mathbf{r}_i = (x_i, y_i, z_i)$
- центральная частота и полоса сигнала: $f_0$, $B$

#### 6.1.2 Вычисление разностей фаз

Разность фаз между приемниками $i$ и $j$:

$$\Delta\phi_{ij} = \arg(S_i \cdot S_j^*) = \phi_i - \phi_j$$

где $S_j^*$ — комплексно-сопряженный сигнал.

Теоретическая разность фаз для плоской волны:

$$\Delta\phi_{ij}^{theor} = \frac{2\pi f_0}{c} \mathbf{s} \cdot (\mathbf{r}_i - \mathbf{r}_j)$$

где:
- $\mathbf{s}$ — единичный вектор направления прихода сигнала
- $c$ — скорость звука
- $f_0$ — центральная частота сигнала

Фазовая интерферометрия формирует систему уравнений для оценки $\mathbf{s}$.

#### 6.1.3 Решение задачи DOA

**Система уравнений:**

Для $N$ приемников получаем $M = \frac{N(N-1)}{2}$ уравнений:

$$\Delta\phi_{ij} = \frac{2\pi f_0}{c} \mathbf{s} \cdot (\mathbf{r}_i - \mathbf{r}_j) + n_{ij}, \quad i < j$$

где $n_{ij}$ — ошибка измерения фазы.

**Оценка единичного вектора направления:**

$$\hat{\mathbf{s}} = \underset{\|\mathbf{s}\| = 1}{\operatorname{argmin}} \sum_{i<j} \left(\Delta\phi_{ij} - \frac{2\pi f_0}{c} \mathbf{s} \cdot (\mathbf{r}_i - \mathbf{r}_j)\right)^2$$

**Преобразование в азимут и угол места:**

$$\theta = \arctan2(s_y, s_x) \quad \text{(азимут)}$$

$$\varphi = \arcsin(s_z) \quad \text{(угол места)}$$

где $\mathbf{s} = (s_x, s_y, s_z)$.

**Оценка угловых ошибок:**

$$\sigma_\theta = \frac{c}{2\pi f_0 \|\mathbf{r}_i - \mathbf{r}_j\| \cos(\varphi)} \cdot \sigma_{\Delta\phi}$$

$$\sigma_\varphi = \frac{c}{2\pi f_0 \|\mathbf{r}_i - \mathbf{r}_j\|} \cdot \sigma_{\Delta\phi}$$

где $\sigma_{\Delta\phi}$ — стандартное отклонение ошибки измерения фазы.

**Замечание:** В LBL (Long Baseline) или SBL (Short Baseline с большой базой) разности времен прихода между удалёнными приемниками дают возможность определить и направление, и дальность, так как фронт волны не приближается к плоскому. В USBL с малой базой дальность не наблюдаема.

### 6.2 Оценка дальности

#### 6.2.1 Общие положения

Система не предполагает синхронизации с маяком. Время излучения неизвестно. Абсолютный TOA оценивается относительно начала окна приема.

**Время прихода (TOA):**

$$t_{TOA} = t_0 + \frac{D}{c}$$

где:
- $t_0$ — неизвестное время излучения
- $D$ — дальность до маяка
- $c$ — скорость звука

#### 6.2.2 Основной режим — пассивный (односторонний канал)

**Корреляционная оценка TOA:**

Оценка времени прихода по известной сигнатуре сигнала:

$$\hat{t}_{TOA} = \arg\max_t \left| \int s_{ref}(\tau) s_{RX}^*(t + \tau) d\tau \right|$$

где:
- $s_{ref}(t)$ — опорный сигнал (известная сигнатура)
- $s_{RX}(t)$ — принятый сигнал

**Оценка групповой задержки (широкополосный сигнал):**

Для CHIRP-сигнала групповая задержка связана с дальностью:

$$\tau_g = \frac{D}{c} = \frac{f_{inst} - f_0}{B/T_p}$$

где $f_{inst}$ — мгновенная частота в момент прихода сигнала.

#### 6.2.3 Дополнительный режим — ответчик (двухходовой канал)

Активный маяк-ответчик используется для валидации и повышения точности.

**Дальность для режима ответчика:**

$$R = \frac{c \cdot (t_{RX} - t_0 - \tau_{reply})}{2}$$

где:
- $t_{RX}$ — время приема ответного сигнала
- $t_0$ — время запроса
- $\tau_{reply}$ — задержка ответчика

#### 6.2.4 Вспомогательные методы

**Оценка дальности по TDOA + DOA:**

Разность времен прихода (TDOA) между приемниками:

$$\Delta t_{ij} = t_i - t_j = \frac{(\mathbf{r}_i - \mathbf{r}_j) \cdot \mathbf{s}}{c}$$

Комбинируя TDOA и DOA, можно улучшить оценку дальности при известной геометрии.

**Фильтрация последовательных измерений:**

Используются фильтры Калмана или Particle Filter для сглаживания траектории и уменьшения ошибок.

### 6.3 Расчет пространственных координат

**Преобразование DOA и дальности в декартовы координаты:**

$$\mathbf{r}_{beacon} = D \cdot \mathbf{s} = D \begin{pmatrix} \cos(\varphi) \cos(\theta) \\ \cos(\varphi) \sin(\theta) \\ \sin(\varphi) \end{pmatrix}$$

где:
- $D$ — оцененная дальность
- $\theta$ — азимут
- $\varphi$ — угол места

**Пространственная ошибка:**

$$\sigma_{XYZ} = \sqrt{\sigma_X^2 + \sigma_Y^2 + \sigma_Z^2}$$

где ошибки по осям связаны с угловыми ошибками и ошибкой дальности:

$$\sigma_X = \sqrt{(D \sigma_\theta \cos(\varphi) \cos(\theta))^2 + (\sigma_D \cos(\varphi) \cos(\theta))^2}$$

$$\sigma_Y = \sqrt{(D \sigma_\theta \cos(\varphi) \sin(\theta))^2 + (\sigma_D \cos(\varphi) \sin(\theta))^2}$$

$$\sigma_Z = \sqrt{(D \sigma_\varphi)^2 + (\sigma_D \sin(\varphi))^2}$$

**Ошибка дальности:**

$$\sigma_D = \frac{c}{2B} \cdot \frac{1}{\sqrt{SNR \cdot T_p \cdot B}}$$

где $B$ — эффективная полоса частот сигнала.

## 7. Оптимизация параметров

### 7.1 Параметры оптимизации

- **Геометрия антенны:** размеры $a$, высота $h$, базисы $\|\mathbf{r}_i - \mathbf{r}_j\|$
- **Полоса частот:** $B = f_{end} - f_{start}$
- **Центральная частота:** $f_0 = \frac{f_{start} + f_{end}}{2}$
- **Длительность сигнала:** $T_p$

### 7.2 Целевая функция

**Цель:** минимизация пространственной ошибки $\sigma_{XYZ}$ при выполнении ограничений:

$$\min_{a, h, B, f_0, T_p} \sigma_{XYZ}(a, h, B, f_0, T_p)$$

**Ограничения:**

- $f_{start} \geq f_{\min}$, $f_{end} \leq f_{\max}$ (диапазон трансдусера)
- $f_s \geq 2 f_{end}$ (критерий Найквиста)
- $T_p \leq T_{p,\max} = \frac{2D}{c} - \tau_{guard}$
- $SNR_{ADC} \geq SNR_{target}$
- $\sigma_\theta, \sigma_\varphi \leq \sigma_{target}$ (требуемая угловая точность)

### 7.3 Стратегии оптимизации

**Стратегия 1: Максимальный Tp + Минимальный VGA gain**

Максимизация длительности импульса для улучшения SNR, затем минимизация усиления VGA:

$$\max_{T_p} T_p \quad \text{при} \quad T_p \leq T_{p,\max}$$

$$\min_{G_{VGA}} G_{VGA} \quad \text{при} \quad SNR_{ADC} \geq SNR_{target}$$

**Стратегия 2: Минимальный Tp для целевого SNR**

Минимизация длительности импульса при достижении целевого SNR:

$$\min_{T_p} T_p \quad \text{при} \quad SNR_{ADC} \geq SNR_{target}$$

## 8. Методика моделирования

- имитационное моделирование распространения сигнала
- Монте-Карло моделирование ошибок
- сравнение геометрий «ромб» и «пирамида»
- анализ чувствительности к ошибкам параметров

**Метод Монте-Карло:**

Для оценки статистических характеристик ошибок выполняется $N$ независимых симуляций:

$$\hat{\sigma}_{XYZ} = \sqrt{\frac{1}{N-1} \sum_{k=1}^{N} (\mathbf{r}_k - \bar{\mathbf{r}})^2}$$

где $\bar{\mathbf{r}} = \frac{1}{N} \sum_{k=1}^{N} \mathbf{r}_k$ — среднее значение оцененных координат.

## 9. Результаты разработки

- оптимальные геометрические параметры антенн
- рекомендуемые частотные диапазоны
- оценки достижимой точности
- графики зависимости точности от расстояния, полосы частот, геометрии антенны

## 10. Требования к отчетной документации

- описание моделей и допущений
- формулы и алгоритмы оценки координат
- результаты численного моделирования
- выводы и рекомендации

## 11. Перспективы развития

- учет многолучевости
- адаптивный выбор частоты
- совместная работа с DVL / INS
